pipeline {
       agent any
       environment {
           DOCKER_HUB_CREDENTIALS = credentials('docker-hub-credentials')
           DOCKER_IMAGE_NAME = "jeonginho/inhorepo"
           DOCKER_IMAGE_TAG = "${BUILD_NUMBER}"
       }
       stages {
           stage('Build Docker Image') {
               steps {
                   script {
                       docker.build("${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}")
                   }
               }
           }
           stage('Push Docker Image') {
               steps {
                   script {
                       docker.withRegistry('https://index.docker.io/v1/', 'docker-hub-credentials') {
                           docker.image("${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}").push()
                           docker.image("${DOCKER_IMAGE_NAME}:${DOCKER_IMAGE_TAG}").push("latest")
                       }
                   }
               }
           }
       }
   }